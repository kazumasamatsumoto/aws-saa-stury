# AWS Storage Gateway

AWS Storage Gateway は、オンプレミス環境と AWS クラウドストレージを統合するハイブリッドクラウドストレージサービスです。

## 概要

Storage Gateway は、オンプレミスのアプリケーションから AWS のストレージサービスへのシームレスな接続を提供します。主にデータバックアップ、災害対策、クラウド移行、クラウドバースティング、ストレージ階層化などのユースケースで利用されます。

## ゲートウェイタイプ

Storage Gateway には以下の 4 つのタイプがあります：

### 1. Amazon S3 ファイルゲートウェイ

- SMB（Server Message Block）または NFS（Network File System）プロトコルを使用してファイル共有を提供
  - SMB プロトコル（バージョン 2.0、2.1、3.0）
    - Windows ベースのクライアントに最適
    - Active Directory との統合が可能
    - Windows のアクセス制御リスト（ACL）をサポート
  - NFS プロトコル（バージョン 3、4.0、4.1）
    - Linux/UNIX ベースのクライアントに最適
    - POSIX 準拠のファイルシステム
    - ファイル権限とオーナーシップの保持
- データは Amazon S3 に保存
- よく使用されるファイルはローカルにキャッシュ
- S3 のストレージクラスを活用可能（S3 Standard, S3 Intelligent-Tiering, S3 Standard-IA 等）

### 2. Amazon FSx ファイルゲートウェイ

- オンプレミス環境から Amazon FSx for Windows File Server へのアクセスを提供
- SMB プロトコル（バージョン 2.0、2.1、3.0）のみをサポート
  - Windows ネイティブのファイル共有機能
  - DFS（Distributed File System）のサポート
  - Windows ACL と NTFS アクセス許可
- Windows ベースのアプリケーションに最適化
- Active Directory との統合
  - ユーザー認証と認可
  - グループポリシーの適用
  - ファイルレベルのセキュリティ

### 3. ボリュームゲートウェイ

#### キャッシュモード

- プライマリデータは S3 に保存
- 頻繁にアクセスされるデータをローカルにキャッシュ
- ストレージ容量を節約可能

#### 保管モード

- プライマリデータをローカルに保存
- 非同期で S3 にバックアップ
- 低レイテンシーでのアクセスが可能

### 4. テープゲートウェイ

- 既存のテープベースのバックアップインフラを AWS に移行
- Virtual Tape Library (VTL)として機能
- データは S3 Glacier や S3 Glacier Deep Archive に保存可能
- 既存のバックアップソフトウェアと互換性あり

## 主な特徴

- ハイブリッドクラウドストレージの実現
- データの暗号化（転送中および保存時）
- 帯域幅の最適化
- スケーラブルなストレージ
- 既存のアプリケーションとの互換性
- 高可用性と耐久性
- コスト効率の良いストレージソリューション

## ユースケース

1. クラウドバックアップ
2. 災害対策
3. クラウド移行
4. ファイル共有
5. ハイブリッドクラウドストレージ
6. テープバックアップの置き換え

## セキュリティ

- AWS IAM によるアクセス制御
- データの暗号化（転送中および保存時）
- VPC エンドポイントのサポート
- AWS KMS との統合

## 料金

- ゲートウェイの利用料金
- データ転送料金
- ストレージ料金（S3, Glacier 等）
- キャッシュストレージ料金（該当する場合）

## ベストプラクティス

1. 適切なゲートウェイタイプの選択
2. 十分なキャッシュストレージの確保
3. 定期的なバックアップとメンテナンス
4. ネットワーク帯域幅の最適化
5. モニタリングとアラートの設定
