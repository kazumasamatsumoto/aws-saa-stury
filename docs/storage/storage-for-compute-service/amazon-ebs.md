# Amazon Elastic Block Store (EBS)

Amazon EBS は、AWS EC2 インスタンス用に設計されたブロックレベルのストレージサービスです。

## 主な特徴

- **高可用性**: 特定のアベイラビリティーゾーン内で自動的にレプリケートされ、高い耐久性を提供
- **永続的ストレージ**: EC2 インスタンスを停止または終了しても、データは保持される
- **柔軟なボリュームタイプ**: ワークロードに応じて最適なストレージタイプを選択可能

## EBS ボリュームタイプ

### 1. SSD (Solid State Drive)

- **gp3, gp2 (汎用 SSD)**
  - 一般的なワークロード向け
  - バランスの取れたコストとパフォーマンス
- **io2, io1 (Provisioned IOPS SSD)**
  - 高性能な I/O 操作が必要なワークロード向け
  - データベースなどの重要なビジネスアプリケーションに最適
- **io2 Block Express**
  - EBS の最高性能を提供する SSD ボリューム
  - 最大 256,000 IOPS と 4,000 MB/秒のスループット
  - 64TiB までのボリュームサイズをサポート
  - サブミリ秒レベルのレイテンシー
  - 99.999%のボリューム耐久性
  - 大規模なデータベースやレイテンシーに敏感なワークロードに最適

### 2. HDD (Hard Disk Drive)

- **st1 (スループット最適化 HDD)**
  - ビッグデータ、データウェアハウス、ログ処理向け
- **sc1 (Cold HDD)**
  - アクセス頻度の低いワークロード向け
  - 最も低コストなオプション

## EBS ボリュームの仕様詳細

### 耐久性

耐久性とは、データが失われずに保持される確率を示す指標です。

- すべての EBS ボリュームタイプ: 99.999%（年間で 0.001%未満のデータ損失リスク）
- io2 Block Express: 99.999%
- データは同一 AZ 内で自動的にレプリケート（複製）され、ハードウェア故障からデータを保護

### ボリュームサイズ

1 つのボリュームで作成できるストレージの容量を示します。必要に応じて後から拡張することも可能です。

- gp2/gp3: 1 GiB - 16 TiB（1GB = 約 1,000MB、1TB = 約 1,000GB）
- io1/io2: 4 GiB - 16 TiB
- io2 Block Express: 4 GiB - 64 TiB（大規模データベース向け）
- st1: 125 GiB - 16 TiB
- sc1: 125 GiB - 16 TiB

### 最大 IOPS

IOPS（Input/Output Operations Per Second）は、1 秒間にどれだけの読み書き操作ができるかを示す性能指標です。数値が大きいほど、より多くのデータ処理が可能です。

- gp3: 16,000（一般的なビジネスアプリケーションに十分）
- gp2: 16,000
- io1: 64,000（高性能データベース向け）
- io2: 64,000
- io2 Block Express: 256,000（最高性能が必要な場合）
- st1: 500
- sc1: 250

### 最大スループット

1 秒間にどれだけのデータ量を転送できるかを示す指標です。大容量のファイル転送や動画処理などで重要になります。

- gp3: 1,000 MB/秒（1GB のファイルを約 1 秒で転送可能）
- gp2: 250 MB/秒
- io1: 1,000 MB/秒
- io2: 1,000 MB/秒
- io2 Block Express: 4,000 MB/秒（大規模データ処理に最適）
- st1: 500 MB/秒
- sc1: 250 MB/秒

### EBS マルチアタッチ

1 つのボリュームを複数のサーバーで同時に使用できる機能です。データベースの冗長化やクラスター構成で活用されます。

- io1/io2 ボリュームでのみサポート（高性能タイプのみ対応）
- 同一 AZ 内の複数の EC2 インスタンスに同時にアタッチ可能
- 最大 16 個のインスタンスに接続可能（1 つのボリュームを最大 16 台のサーバーで共有可能）
- クラスタリング化されたデータベースや HA（高可用性）シナリオに最適
  - 例：Oracle RAC（複数サーバーでデータベースを共有）
  - 例：Windows Server フェイルオーバークラスタリング

### ブートボリューム

OS やシステムファイルを格納する起動用ディスクとしての利用に関する仕様です。

- すべての SSD タイプ（gp2/gp3/io1/io2）がブートボリュームとして使用可能
  - 高速な起動とシステム応答性が必要なため、SSD タイプのみ対応
- HDD タイプ（st1/sc1）はブートボリュームとして使用不可
  - 低速なため、システムディスクには不適切
- ルートデバイスボリュームは暗号化可能（セキュリティ要件の高い環境で重要）
- 推奨サイズ: 最低 8 GiB（OS によって異なる）
  - Windows: 通常 30GB 以上推奨
  - Linux: 通常 8GB 以上推奨

## 主な用途

- データベース
- エンタープライズアプリケーション
- 開発/テスト環境
- ビジネスクリティカルなアプリケーション

## 重要な機能

### スナップショット

- ポイントインタイムバックアップの作成が可能
- S3 に増分バックアップとして保存
- リージョン間でのコピーが可能

### 暗号化

- AES-256 暗号化をサポート
- 保管時および転送時のデータを暗号化
- AWS KMS と統合

### 柔軟な管理

- ボリュームサイズの動的な変更が可能
- パフォーマンスの調整が可能
- タグ付けによる管理

## ベストプラクティス

1. **適切なボリュームタイプの選択**

   - ワークロードの要件に基づいて最適なタイプを選択

2. **定期的なバックアップ**

   - スナップショットを定期的に取得
   - クロスリージョンでのバックアップを検討

3. **モニタリング**

   - CloudWatch を使用してパフォーマンスを監視
   - 必要に応じてボリュームの設定を調整

4. **コスト最適化**
   - 未使用のボリュームを定期的に確認
   - 不要なスナップショットの削除
