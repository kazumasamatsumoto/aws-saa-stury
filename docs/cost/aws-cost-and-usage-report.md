# AWS Cost and Usage Report

・AWS のコストに関する詳細かつ膨大なデータがまとめられたレポートサービス

・最も包括的なコストと使用状況のデータを提供する

・レポートは CSV ファイルで出力される。また、S3 にレポートファイルを配信し、加工・フィルタリング（アカウント単位、日次単位）したコストデータを取得できる

## 主な特徴

・時間単位、日単位、月単位でのコストデータの取得が可能

・リソースタグ別、サービス別、アカウント別などの詳細な分類でコストを確認可能

・予約インスタンス（RI）や Savings Plans の使用状況と償却情報を含む

・Athena を使用して SQL クエリでデータを分析可能

・QuickSight と連携してビジュアライゼーションを作成可能

## レポートに含まれる主な情報

・使用した AWS サービスの詳細
・料金タイプ（オンデマンド、スポット、予約インスタンスなど）
・リソースのタグ情報
・使用量の詳細（データ転送量、ストレージ使用量など）
・適用された割引情報
・料金の内訳

## 活用例

・部門別のコスト配分
・プロジェクト別の予算管理
・リソースの最適化機会の特定
・長期的なコストトレンド分析
・無駄な支出の発見と削減

## 設定のベストプラクティス

・時間単位の詳細度でレポートを作成し、より細かな分析を可能にする
・リソース ID を含めることで、特定のリソースのコストを追跡
・Athena との統合を有効にし、SQL による分析を可能にする
・必要に応じてデータを圧縮して保存コストを削減

## Athena と S3 Select の比較

| 機能           | Amazon Athena                          | S3 Select                            |
| -------------- | -------------------------------------- | ------------------------------------ |
| クエリ対象     | 複数のファイル、テーブル、データベース | 単一の S3 オブジェクト               |
| クエリ言語     | 標準 SQL (Presto ベース)               | 単純な SQL 式                        |
| ユースケース   | 複雑な分析、大規模データの集計         | シンプルなフィルタリング、データ抽出 |
| パフォーマンス | 大規模データセットに最適               | 単一ファイルの高速検索に最適         |
| コスト         | スキャンしたデータ量に応じた課金       | 処理したデータ量に応じた課金         |
| セットアップ   | テーブル定義、スキーマ設定が必要       | 最小限の設定で利用可能               |
| データ形式     | CSV, JSON, Parquet, ORC など多様       | CSV, JSON, Parquet                   |
| 結合操作       | テーブル結合が可能                     | 結合操作は不可                       |

## 具体的なユースケース例

### Amazon Athena の利用シーン

・複数月にわたるコストトレンド分析
・サービス間の使用量の相関分析
・部門やプロジェクト間のコスト比較
・タグベースの詳細なコスト分析
・予約インスタンスの使用率最適化分析
・複数アカウントにまたがるコスト集計
・カスタムレポートの作成

### S3 Select の利用シーン

・特定の日付のコストデータの抽出
・単一サービスの使用量データの取得
・特定のリソース ID に関連するコストの確認
・月次レポートからの特定項目の抽出
・大きなレポートファイルからの必要な列のみの取得
・簡易的なフィルタリングによるコスト確認
